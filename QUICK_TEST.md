# 快速测试指南 - v1.3.0

## ⚡ 5分钟快速验证

### 步骤 1：重新加载扩展 (30秒)

1. 打开 `chrome://extensions/`
2. 找到 **Gemini页面总结助手**
3. 点击 **🔄 刷新**按钮
4. 确认版本号：**1.3.0**
5. 确认权限：不应再显示 "debugger" 权限

### 步骤 2：基本功能测试 (2分钟)

#### 测试用例 1：正常网页

```
1. 打开：https://www.zhihu.com（或任意文章页面）
2. 点击扩展图标
3. 点击"总结"按钮
4. 观察：
   ✅ Gemini 窗口在右侧打开
   ✅ 自动切换到 "推理、数学和编码2.5 Pro"
   ✅ 输入框自动填充内容
   ✅ 自动点击提交
```

#### 测试用例 2：受限页面（应该被阻止）

```
1. 打开：chrome://extensions/
2. 点击扩展图标
3. 点击"总结"按钮
4. 观察：
   ✅ 显示错误提示（不支持此类页面）
   ✅ 不会出现 "调试器无法附加" 错误
```

### 步骤 3：查看日志 (1分钟)

```
1. 在 chrome://extensions/ 页面
2. 找到扩展，点击 "Service Worker"
3. 在成功的测试中，应该看到：
   🚀 开始内容提交流程...
   ✅ 步骤1/4: 获取当前标签页成功
   ✅ 找到2.5 Pro选项，点击选择
   ✅ 提示词已填充
   ✅ 已点击提交按钮！
```

### 步骤 4：验证模型选择 (1分钟)

```
1. 在 Gemini 网站手动切换到 "Flash" 模型
2. 在普通网页使用扩展
3. 观察：
   ✅ 应自动检测到非 2.5 Pro 模型
   ✅ 自动点击模型选择器
   ✅ 自动选择 "推理、数学和编码2.5 Pro"
```

## 🐛 常见问题排查

### 问题 1：没有自动切换到 2.5 Pro

**排查步骤**：
```
1. 打开 Service Worker 控制台
2. 查找日志：
   "🔍 查找2.5 Pro选项，共 XX 个候选项"
3. 查看是否打印了所有候选项文本
4. 确认是否有包含 "推理、数学和编码" 的选项
```

**可能原因**：
- Gemini 页面结构发生变化
- 等待时间不够（增加 setTimeout 延迟）
- DOM 选择器需要更新

### 问题 2：内容没有填充到输入框

**排查步骤**：
```
1. 查看控制台日志："✅ 找到输入框"
2. 检查是否有错误信息
3. 验证输入框选择器是否正确
```

**可能原因**：
- Gemini 输入框结构变化
- 页面加载未完成

### 问题 3：没有自动点击提交按钮

**排查步骤**：
```
1. 查看日志中的按钮得分
2. 确认最高得分是否 > 10
3. 检查按钮位置和属性
```

## ✅ 成功标准

测试通过的标准：

- [x] 扩展版本号为 1.3.0
- [x] 不再请求 debugger 权限
- [x] 普通网页可以正常使用
- [x] 受限页面显示友好错误
- [x] 自动切换到 2.5 Pro 模型
- [x] 内容自动填充并提交
- [x] 没有 "调试器无法附加" 错误

## 🎯 关键改进验证

### 改进 1：移除 PDF 生成 ✅

```
验证：查看 background.js
❌ 不应包含：generatePDF()
❌ 不应包含：chrome.debugger.attach()
✅ 应包含：submitContentToGemini()
✅ 应包含：buildPromptWithContent()
```

### 改进 2：模型识别文本修复 ✅

```
验证：查看 background.js 中的 switchTo25Pro 函数
✅ 应包含：text.includes('推理、数学和编码')
✅ 应包含：text.includes('2.5')
✅ 应包含：text.includes('Pro')
```

### 改进 3：权限简化 ✅

```
验证：查看 manifest.json
❌ 不应包含："debugger"
❌ 不应包含："offscreen"
❌ 不应包含："pageCapture"
✅ 应包含："activeTab", "storage", "scripting", "tabs"
```

## 📊 测试结果记录

| 测试项 | 状态 | 备注 |
|--------|------|------|
| 版本号更新 | ⬜ | 应为 1.3.0 |
| 权限简化 | ⬜ | 无 debugger 权限 |
| 正常网页 | ⬜ | 成功提交 |
| 受限页面 | ⬜ | 友好错误提示 |
| 模型切换 | ⬜ | 自动切换到 2.5 Pro |
| 内容填充 | ⬜ | 正文在提示词中 |
| 自动提交 | ⬜ | 点击提交按钮 |

---

**测试完成后，请在表格中勾选 ✅ 或标记 ❌**

**测试日期**：___________
**测试人员**：___________
**测试结果**：通过 / 失败
